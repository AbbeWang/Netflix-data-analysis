{
    "contents" : "library(ggplot2)\nlibrary(lubridate)\n\n# getting amazon visitor data\navisitor = read.csv(\"web_traffic_data_-_updated.csv\",header=FALSE, nrows = 45394,skip = 77197)\navisitor = avisitor[c(1:21863, 45299:45394),]\navisitor$V3 = as.character(avisitor$V3)\navisitor$V3 = gsub(x=avisitor$V3,pattern=\" 04:00:00+00:00\",replacement=\"\",fixed=T)\navisitor$V3 = gsub(x=avisitor$V3,pattern=\"05:00:00+00:00\",replacement=\"\",fixed=T)\navisitor$V3 = ymd(avisitor$V3)\n\n\n#getting amazon revenue data\narevenue = read.csv(\"revenue.csv\")\narevenue$Period = dmy_hm(arevenue$Period)\n\n#plot revenue data\nqplot(arevenue$Period, arevenue$AMZN.Revenue..Quarterly., geom = c(\"point\",\"smooth\"))\nqplot(arevenue$Period, log(arevenue$AMZN.Revenue..Quarterly.), geom = c(\"point\",\"smooth\"))\n\n#subtract 2010-2015 revenue\narevenue1 = arevenue[1:22,]\nqplot(arevenue1$Period, arevenue1$AMZN.Revenue..Quarterly., geom = c(\"point\",\"smooth\"),method = \"lm\")\nqplot(arevenue1$Period, log(arevenue1$AMZN.Revenue..Quarterly.), geom = c(\"point\",\"smooth\"), method = \"lm\")\n\n\n#regression line\nm1 = lm(arevenue1$AMZN.Revenue..Quarterly. ~ arevenue1$Period)\nsummary(m1)\n\nplot(m1$residuals ~ arevenue1$Period)\nabline(h = 0, lty = 3)\n\nplot(arevenue1$AMZN.Revenue..Quarterly. ~ arevenue1$Period)\nabline(m1)\n\n\n# Q3 revenue data\nq3_revenue = arevenue[month(arevenue[,1]) == 9,c(1,2)]\nqplot(q3_revenue$Period, q3_revenue$AMZN.Revenue..Quarterly., geom = c(\"point\",\"smooth\"))\nqplot(q3_revenue$Period, log(q3_revenue$AMZN.Revenue..Quarterly.), geom = c(\"point\",\"smooth\"))\n\n# 2005-2014\nqplot(q3_revenue$Period[1:10], q3_revenue$AMZN.Revenue..Quarterly.[1:10], geom = c(\"point\",\"smooth\"),method = \"lm\")\nqplot(q3_revenue$Period[1:10], log(q3_revenue$AMZN.Revenue..Quarterly.[1:10]), geom = c(\"point\",\"smooth\"),method = \"lm\")\n\n\n## no log \nm2 = lm(q3_revenue$AMZN.Revenue..Quarterly.[1:10] ~ q3_revenue$Period[1:10])\nsummary(m2)\n\nplot(m2$residuals ~ q3_revenue$Period[1:10])\nabline(h = 0, lty = 3)\n\nplot(q3_revenue$AMZN.Revenue..Quarterly.[1:10] ~ q3_revenue$Period[1:10])\nabline(m2)\n\n## log -- better\nm3 = lm(log(q3_revenue$AMZN.Revenue..Quarterly.[1:10]) ~ q3_revenue$Period[1:10])\nsummary(m3)\n\nplot(m3$residuals ~ q3_revenue$Period[1:10])\nabline(h = 0, lty = 3)\n\nplot(log(q3_revenue$AMZN.Revenue..Quarterly.[1:10]) ~ q3_revenue$Period[1:10])\nabline(m3)\n\n\n\n# 2010-2014\nqplot(q3_revenue$Period[1:5], q3_revenue$AMZN.Revenue..Quarterly.[1:5], geom = c(\"point\",\"smooth\"),method = \"lm\")\nqplot(q3_revenue$Period[1:5], log(q3_revenue$AMZN.Revenue..Quarterly.[1:5]), geom = c(\"point\",\"smooth\"),method = \"lm\")\n\n## no log -- better -- best\nm2 = lm(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$Period[1:5])\nsummary(m2)\n\nplot(m2$residuals ~ q3_revenue$Period[1:5])\nabline(h = 0, lty = 3)\n\nplot(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$Period[1:5])\nabline(m2)\n\n## log\nm3 = lm(log(q3_revenue$AMZN.Revenue..Quarterly.[1:5]) ~ q3_revenue$Period[1:5])\nsummary(m3)\n\nplot(m3$residuals ~ q3_revenue$Period[1:5])\nabline(h = 0, lty = 3)\n\nplot(log(q3_revenue$AMZN.Revenue..Quarterly.[1:5]) ~ q3_revenue$Period[1:5])\nabline(m3)\n\n\n# calculating q3 2015\nx = ymd(\"2015-09-30\")\ny = m2$coefficients[1] + m2$coefficients[2]*as.numeric(x)\n\n\n# q3 ~ q1 + q2\nq3_revenue$q1 = arevenue$AMZN.Revenue..Quarterly.[month(arevenue[,1]) == 3 & year(arevenue[,1]) < 2015]\nq3_revenue$q2 = arevenue$AMZN.Revenue..Quarterly.[month(arevenue[,1]) == 6 & year(arevenue[,1]) < 2015]\n\n\n# q1 & q2 has high dependency, therefore only examine q2\ncor(q3_revenue$q1, q3_revenue$q2)\n\nm4 = lm(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$q2[1:5])\nsummary(m4)\n\nplot(m4$residuals ~ q3_revenue$q2[1:5])\nabline(h = 0, lty = 3)\n\nplot(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$q2[1:5])\nabline(m4)\n\n\n# recalculating q3 2015\nx = arevenue1[1,2]\ny = m4$coefficients[1] + m4$coefficients[2]*x\n\n\n\n# traffic * weather\nqplot(avisitor$V3,avisitor$V4, geom = c(\"point\",\"smooth\"))\nqplot(avisitor$V3, log(avisitor$V4), geom = c(\"point\",\"smooth\"))\n\navisitor$V3 = as.factor(avisitor$V3)\ndf1 = tapply(avisitor$V4, avisitor$V3, sum)\nn = names(df1)\ndf = data.frame(as.POSIXct(n), df1, row.names = NULL)\n\nqplot(df$as.POSIXct.n.,df$df1, geom = c(\"point\",\"smooth\"))\nqplot(df$as.POSIXct.n.,log(df$df1), geom = c(\"point\",\"smooth\"))\n\n\n# getting weather data\nweather = read.table(\"Complete_TAVG_complete.txt\",header=FALSE, skip = 3093)\nweather = weather[,1:4]\nweather$date = ymd(\"2007/8/15\",\"2007/9/15\",\"2007/10/15\",\"2007/11/15\",\"2007/12/15\",\"2008/1/15\"\n                   ,\"2008/2/15\",\"2008/3/15\",\"2008/4/15\",\"2008/5/15\",\"2008/6/15\",\"2008/7/15\"\n                   ,\"2008/8/15\",\"2008/9/15\",\"2008/10/15\",\"2008/11/15\",\"2008/12/15\",\"2009/1/15\"\n                   ,\"2009/2/15\",\"2009/3/15\",\"2009/4/15\",\"2009/5/15\",\"2009/6/15\",\"2009/7/15\"\n                   ,\"2009/8/15\",\"2009/9/15\",\"2009/10/15\",\"2009/11/15\",\"2009/12/15\",\"2010/1/15\"\n                   ,\"2010/2/15\",\"2010/3/15\",\"2010/4/15\",\"2010/5/15\",\"2010/6/15\",\"2010/7/15\"\n                   ,\"2010/8/15\",\"2010/9/15\",\"2010/10/15\",\"2010/11/15\",\"2010/12/15\",\"2011/1/15\"\n                   ,\"2011/2/15\",\"2011/3/15\",\"2011/4/15\",\"2011/5/15\",\"2011/6/15\",\"2011/7/15\"\n                   ,\"2011/8/15\",\"2011/9/15\",\"2011/10/15\",\"2011/11/15\",\"2011/12/15\",\"2012/1/15\"\n                   ,\"2012/2/15\",\"2012/3/15\",\"2012/4/15\",\"2012/5/15\",\"2012/6/15\",\"2012/7/15\"\n                   ,\"2012/8/15\",\"2012/9/15\",\"2012/10/15\",\"2012/11/15\",\"2012/12/15\",\"2013/1/15\"\n                   ,\"2013/2/15\",\"2013/3/15\",\"2013/4/15\",\"2013/5/15\",\"2013/6/15\",\"2013/7/15\"\n                   ,\"2013/8/15\",\"2013/9/15\",\"2013/10/15\",\"2013/11/15\",\"2013/12/15\",\"2014/1/15\"\n                   ,\"2014/2/15\",\"2014/3/15\",\"2014/4/15\",\"2014/5/15\",\"2014/6/15\",\"2014/7/15\"\n                   ,\"2014/8/15\",\"2014/9/15\",\"2014/10/15\",\"2014/11/15\",\"2014/12/15\")\n\n# plot monthly weather data\nqplot(weather$date, weather$V3, geom = c(\"point\",\"smooth\"))\n\n#plot together\nplot(weather$date, weather$V3, axes = FALSE, xlab = \"\", ylab = \"\")\npar(new = TRUE)\nplot(df$as.POSIXct.n.,df$df1, xlab = \"\", ylab = \"\", col = \"red\", type = \"l\")\n\n\n\n\n# getting Amazon stock data\nastock = read.csv(\"table (1).csv\",header=TRUE, nrows = 1964)\nastock$Date = ymd(astock$Date)\n\n# plot stock data\nqplot(astock$Date, astock$Adj.Close, geom = c(\"point\",\"smooth\"))\nqplot(astock$Date, log(astock$Adj.Close), geom = c(\"point\",\"smooth\"))\n\n\n#plot revenue, traffic and stock together\nplot(arevenue$Period, arevenue$AMZN.Revenue..Quarterly., axes = FALSE, xlab = \"\", ylab = \"\")\npar(new = TRUE)\nplot(df$as.POSIXct.n.,df$df1, xlab = \"\",axes = FALSE, ylab = \"\", col = \"grey\", type = \"l\")\npar(new = TRUE)\nplot(astock$Date, astock$Adj.Close, xlab = \"\", ylab = \"\", col = \"red\", type = \"l\")\nlegend(\"topleft\", pch=1, col = \"black\", legend = \"revenue\")\nlegend(\"topleft\", col = c(\"grey\",\"red\"), legend = c(\"visitor\", \"Adj.Close\"), lwd = 1)\n\n\n\n\n\n# get amazon, ebay and overstock data\nrevenue3 = read.csv(\"revenue_shop.csv\")\nrevenue3$Period = dmy_hm(revenue3$Period)\n\n# plot 3 revenue data\nqplot(Period, Revenue, data = revenue3, color = Company, geom = c(\"point\",\"smooth\"), method=\"lm\")\nqplot(Period, Revenue, data = revenue3, color = Company, geom = c(\"point\",\"smooth\"))\n\nggplot(data = revenue3, aes(x=Period, y=Revenue)) + geom_line(aes(color = Company))\n\n\n# plot pie chart\nbp<- ggplot(data = revenue3, aes(x=Period, y=Revenue, fill=Company))+geom_bar(width = 5, stat = \"identity\",aes(color = Company))\nbp\npie <- bp + coord_polar(\"y\", start=0)\npie\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1445034203327.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1717101247",
    "id" : "21010D0",
    "lastKnownWriteTime" : 1445196328,
    "path" : "G:/datacomp/nflx/amzn.R",
    "project_path" : "amzn.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}