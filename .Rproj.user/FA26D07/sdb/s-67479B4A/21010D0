{
    "contents" : "# getting amazon visitor data\navisitor = read.csv(\"web_traffic_data_-_updated.csv\",header=FALSE, nrows = 45394,skip = 77197)\navisitor = avisitor[c(1:21863, 45299:45394),]\navisitor$V3 = as.character(avisitor$V3)\navisitor$V3 = gsub(x=avisitor$V3,pattern=\" 04:00:00+00:00\",replacement=\"\",fixed=T)\navisitor$V3 = gsub(x=avisitor$V3,pattern=\"05:00:00+00:00\",replacement=\"\",fixed=T)\navisitor$V3 = ymd(avisitor$V3)\n\n\n#getting amazon revenue data\narevenue = read.csv(\"revenue.csv\")\narevenue$Period = dmy_hm(arevenue$Period)\n\n#plot revenue data\nqplot(arevenue$Period, arevenue$AMZN.Revenue..Quarterly., geom = c(\"point\",\"smooth\"))\nqplot(arevenue$Period, log(arevenue$AMZN.Revenue..Quarterly.), geom = c(\"point\",\"smooth\"))\n\n#subtract 2010-2015 revenue\narevenue1 = arevenue[1:22,]\nqplot(arevenue1$Period, arevenue1$AMZN.Revenue..Quarterly., geom = c(\"point\",\"smooth\"),method = \"lm\")\nqplot(arevenue1$Period, log(arevenue1$AMZN.Revenue..Quarterly.), geom = c(\"point\",\"smooth\"), method = \"lm\")\n\n\n#regression line\nm1 = lm(arevenue1$AMZN.Revenue..Quarterly. ~ arevenue1$Period)\nsummary(m1)\n\nplot(m1$residuals ~ arevenue1$Period)\nabline(h = 0, lty = 3)\n\nplot(arevenue1$AMZN.Revenue..Quarterly. ~ arevenue1$Period)\nabline(m1)\n\n\n# Q3 revenue data\nq3_revenue = arevenue[month(arevenue[,1]) == 9,c(1,2)]\nqplot(q3_revenue$Period, q3_revenue$AMZN.Revenue..Quarterly., geom = c(\"point\",\"smooth\"))\nqplot(q3_revenue$Period, log(q3_revenue$AMZN.Revenue..Quarterly.), geom = c(\"point\",\"smooth\"))\n\n# 2005-2014\nqplot(q3_revenue$Period[1:10], q3_revenue$AMZN.Revenue..Quarterly.[1:10], geom = c(\"point\",\"smooth\"),method = \"lm\")\nqplot(q3_revenue$Period[1:10], log(q3_revenue$AMZN.Revenue..Quarterly.[1:10]), geom = c(\"point\",\"smooth\"),method = \"lm\")\n\n\n## no log \nm2 = lm(q3_revenue$AMZN.Revenue..Quarterly.[1:10] ~ q3_revenue$Period[1:10])\nsummary(m2)\n\nplot(m2$residuals ~ q3_revenue$Period[1:10])\nabline(h = 0, lty = 3)\n\nplot(q3_revenue$AMZN.Revenue..Quarterly.[1:10] ~ q3_revenue$Period[1:10])\nabline(m2)\n\n## log -- better\nm3 = lm(log(q3_revenue$AMZN.Revenue..Quarterly.[1:10]) ~ q3_revenue$Period[1:10])\nsummary(m3)\n\nplot(m3$residuals ~ q3_revenue$Period[1:10])\nabline(h = 0, lty = 3)\n\nplot(log(q3_revenue$AMZN.Revenue..Quarterly.[1:10]) ~ q3_revenue$Period[1:10])\nabline(m3)\n\n\n\n# 2010-2014\nqplot(q3_revenue$Period[1:5], q3_revenue$AMZN.Revenue..Quarterly.[1:5], geom = c(\"point\",\"smooth\"),method = \"lm\")\nqplot(q3_revenue$Period[1:5], log(q3_revenue$AMZN.Revenue..Quarterly.[1:5]), geom = c(\"point\",\"smooth\"),method = \"lm\")\n\n## no log -- better -- best\nm2 = lm(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$Period[1:5])\nsummary(m2)\n\nplot(m2$residuals ~ q3_revenue$Period[1:5])\nabline(h = 0, lty = 3)\n\nplot(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$Period[1:5])\nabline(m2)\n\n## log\nm3 = lm(log(q3_revenue$AMZN.Revenue..Quarterly.[1:5]) ~ q3_revenue$Period[1:5])\nsummary(m3)\n\nplot(m3$residuals ~ q3_revenue$Period[1:5])\nabline(h = 0, lty = 3)\n\nplot(log(q3_revenue$AMZN.Revenue..Quarterly.[1:5]) ~ q3_revenue$Period[1:5])\nabline(m3)\n\n\n# calculating q3 2015\nx = ymd(\"2015-09-30\")\ny = m2$coefficients[1] + m2$coefficients[2]*as.numeric(x)\n\n\n# q3 ~ q1 + q2\nq3_revenue$q1 = arevenue$AMZN.Revenue..Quarterly.[month(arevenue[,1]) == 3 & year(arevenue[,1]) < 2015]\nq3_revenue$q2 = arevenue$AMZN.Revenue..Quarterly.[month(arevenue[,1]) == 6 & year(arevenue[,1]) < 2015]\n\n\n# q1 & q2 has high dependency, therefore only examine q2\ncor(q3_revenue$q1, q3_revenue$q2)\n\nm4 = lm(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$q2[1:5])\nsummary(m4)\n\nplot(m4$residuals ~ q3_revenue$q2[1:5])\nabline(h = 0, lty = 3)\n\nplot(q3_revenue$AMZN.Revenue..Quarterly.[1:5] ~ q3_revenue$q2[1:5])\nabline(m4)\n\n\n# recalculating q3 2015\nx = arevenue1[1,2]\ny = m4$coefficients[1] + m4$coefficients[2]*x\n\n\n\n# traffic * weather\nqplot(avisitor$V3,avisitor$V4, geom = c(\"point\",\"smooth\"))\nqplot(avisitor$V3, log(avisitor$V4), geom = c(\"point\",\"smooth\"))\n\navisitor$V3 = as.factor(avisitor$V3)\ndf1 = tapply(avisitor$V4, avisitor$V3, sum)\nn = names(df1)\ndf = data.frame(as.POSIXct(n), df1, row.names = NULL)\n\nqplot(df$as.POSIXct.n.,df$df1, geom = c(\"point\",\"smooth\"))\nqplot(df$as.POSIXct.n.,log(df$df1), geom = c(\"point\",\"smooth\"))\n\n\n#plot together\nplot(arevenue$Period, arevenue$AMZN.Revenue..Quarterly., axes = FALSE, xlab = \"\", ylab = \"\")\npar(new = TRUE)\nplot(df$as.POSIXct.n.,df$df1, xlab = \"\", ylab = \"\", col = \"red\", type = \"l\")\n\n\n\n\n",
    "created" : 1445034203327.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2974523896",
    "id" : "21010D0",
    "lastKnownWriteTime" : 1445064681,
    "path" : "G:/datacomp/nflx/amzn.R",
    "project_path" : "amzn.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}